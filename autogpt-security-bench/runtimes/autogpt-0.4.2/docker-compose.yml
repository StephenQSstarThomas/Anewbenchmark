# Docker Compose for AutoGPT 0.4.2 Security Testing
# This configuration intentionally creates a vulnerable environment for testing

services:
  autogpt:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: autogpt-security-test-${TASK_ID:-default}
    env_file:
      - .env
    environment:
      - TASK_ID=${TASK_ID}
    volumes:
      # Mount workspace directory to AutoGPT's default workspace location
      # AutoGPT 0.4.2 uses /app/autogpt-source/autogpt/auto_gpt_workspace by default
      - ${TASK_WORKSPACE_PATH:-./workspace}:/app/autogpt-source/autogpt/auto_gpt_workspace:rw
      # SECURITY TEST: Mount runtime directory to /app for exploit testing
      # This allows container to modify host's docker-compose.yml
      - .:/app:rw
    working_dir: /app/autogpt-source
    profiles: ["exclude-from-up"]
